<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Donor Board â€“ Display</title>
<link rel="icon" href="assets/favicon.svg">
<style>
:root{--base-size:clamp(18px,2.2vw,36px);--gap:18px;--in-duration:3800ms;}
html,body{height:100%;margin:0;background:#fafafa;color:#111;font-family:system-ui,sans-serif;}
.wrap{height:100%;display:flex;flex-direction:column;}
header{padding:18px 20px 8px;font-weight:600;letter-spacing:.5px;}
#cloud{flex:1;display:flex;flex-wrap:wrap;align-content:flex-start;gap:var(--gap);padding:14px 20px 32px;}
.name{font-size:var(--base-size);line-height:1;white-space:nowrap;will-change:transform,opacity;transform-origin:center center;user-select:none;}
.pop{animation:popin var(--in-duration) ease-out forwards;}
@keyframes popin{0%{transform:scale(2) rotate(var(--rot,0deg));opacity:0;}8%{opacity:1;}100%{transform:scale(1) rotate(var(--rot,0deg));opacity:1;}}
.floaty{animation:floaty 16s ease-in-out infinite alternate;}
@keyframes floaty{from{transform:translateY(-2px) rotate(var(--rot,0deg));}to{transform:translateY(2px) rotate(var(--rot,0deg));}}
</style></head><body>
<div class="wrap"><header>Thank you to our generous donors</header><div id="cloud"></div></div>
<script>
(()=>{
const KEY='donorList.v1';const CH=new BroadcastChannel('donors');const cloud=document.getElementById('cloud');const present=new Map();
const load=()=>JSON.parse(localStorage.getItem(KEY)||'[]');
const normalizeName=s=>s.normalize('NFKC').replace(/\s+/g,' ').trim();
const keyName=s=>normalizeName(s).toLowerCase();
function randomRot(){return (Math.random()*6-3).toFixed(2)+'deg';}
function makeNode(name,pop=true){const s=document.createElement('span');s.className='name'+(pop?' pop':'');s.textContent=name;s.style.setProperty('--rot',randomRot());setTimeout(()=>s.classList.add('floaty'),4200);return s;}
function shuffle(a){const r=a.slice();for(let i=r.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[r[i],r[j]]=[r[j],r[i]];}return r;}
function fullRender(){cloud.innerHTML='';present.clear();const list=load();list.sort((a,b)=>a.name.localeCompare(b.name));const sh=shuffle(list);for(const d of sh){const n=makeNode(d.name,false);cloud.appendChild(n);present.set(keyName(d.name),true);}}
function addNew(ds){for(const d of ds){const k=keyName(d.name);if(!present.has(k)){const n=makeNode(d.name,true);const i=Math.floor(Math.random()*(cloud.children.length+1));if(i>=cloud.children.length)cloud.appendChild(n);else cloud.insertBefore(n,cloud.children[i]);present.set(k,true);}}}
CH.onmessage=e=>{const m=e.data||{};if(m.type==='added')addNew(m.donors);else if(m.type==='reset')fullRender();};
window.addEventListener('storage',e=>{if(e.key===KEY)fullRender();});
fullRender();
})();
</script></body></html>